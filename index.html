<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>College Counseling & Recommendation</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <!-- <style>
        /* Global Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            color: #176ddd;
            background-color: #dee3ea;
        }

        /* Navigation Bar */
        nav {
            background: #004080;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            font-weight: 600;
        }

        nav a:hover {
            text-decoration: underline;
        }

        /* Search bar in navigation */
        .search-bar {
            flex-grow: 1;
            margin-left: 20px;
            margin-right: 20px;
        }

        .search-bar input {
            width: 100%;
            padding: 10px;
            border-radius: 30px;
            border: 1px solid #ccc;
        }

        /* Login & Signup buttons */
        .nav-buttons {
            display: flex;
        }

        .nav-buttons a {
            margin-left: 10px;
            padding: 10px 20px;
            border-radius: 30px;
        }

        .login {
            background-color: #ff1493;
            cursor: pointer;
        }

        .signup {
            background-color: #ff69b4;
            cursor: pointer;
        }

        /* Main Section */
        .main-section {
            height: 70vh;
            background-image: url('https://img.freepik.com/free-vector/eeducational-background-with-university-building_1441-840.jpg?t=st=1729055900~exp=1729059500~hmac=13d5904032ab536a189b5bacfe09767f0ae901967d728772de7a6276fa11af75&w=1060');
            background-size: cover;
            background-position: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: rgb(0, 0, 0);
    
        }
        .main-section p:hover {
            color: #8773fa; /* Change this color to whatever you'd like */
        }
        .main-section h1:hover {
    color: #00e117; /* Change this color to whatever you'd like */
}

        .main-section h1 {
            font-size: 3em;
            font-weight: bold;
        }

        .main-section p {
            font-size: 1.2em;
            margin: 20px 0;
        }

        .main-section button {
            background-color: #32cd32;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 1.2em;
            cursor: pointer;
        }

        .main-section button:hover {
            background-color: #2e8b57;
        }

        /* Filter Section */
        .filter-section {
            padding: 20px;
            background: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin: 20px;
            border-radius: 10px;
        }

        .filter-section select, .filter-section input {
            padding: 10px;
            margin: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        /* Results Section */
        .results {
            padding: 20px;
            background: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin: 20px;
            border-radius: 10px;
        }

        .results table {
            width: 100%;
            border-collapse: collapse;
        }

        .results th, .results td {
            padding: 10px;
            border: 1px solid #ddd;
        }

        /* Modal Styles */
        .modal {
            display: none; /* Hidden by default */
            position: fixed;
            z-index: 1; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgb(0,0,0); /* Fallback color */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
            padding-top: 60px;
        }

        .modal-content {
            background-color: #fefefe;
            margin: 5% auto; /* 15% from the top and centered */
            padding: 20px;
            border: 1px solid #888;
            width: 80%; /* Could be more or less, depending on screen size */
            border-radius: 10px;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        .modal input {
            width: calc(100% - 22px);
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        .modal button {
            background-color: #32cd32;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }

        .modal button:hover {
            background-color: #2e8b57;
        }
        
        /* Dropdown for Top Colleges */
.dropdown {
    position: relative;
    display: inline-block;
}

.dropdown-content {
    display: none;
    position: absolute;
    background-color: #004080;
    min-width: 160px;
    box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.2);
    z-index: 1;
}

.dropdown-content a {
    color: white;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
}

.dropdown-content a:hover {
    background-color: #575757;
}

.dropdown:hover .dropdown-content {
    display: block;
}

/* .dropdown:hover a {
    text-decoration: underline;
} */
  /* Import Google font - Poppins */
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap');

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: "Poppins", sans-serif;
}

body {
  background: #E3F2FD;
}

.chatbot-toggler {
  position: fixed;
  bottom: 30px;
  right: 35px;
  outline: none;
  border: none;
  height: 50px;
  width: 50px;
  display: flex;
  cursor: pointer;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  background: #724ae8;
  transition: all 0.2s ease;
}

body.show-chatbot .chatbot-toggler {
  transform: rotate(90deg);
}

.chatbot-toggler span {
  color: #fff;
  position: absolute;
}

.chatbot-toggler span:last-child,
body.show-chatbot .chatbot-toggler span:first-child {
  opacity: 0;
}

body.show-chatbot .chatbot-toggler span:last-child {
  opacity: 1;
}

.chatbot {
  position: fixed;
  right: 35px;
  bottom: 90px;
  width: 420px;
  background: #fff;
  border-radius: 15px;
  overflow: hidden;
  opacity: 0;
  pointer-events: none;
  transform: scale(0.5);
  transform-origin: bottom right;
  box-shadow: 0 0 128px 0 rgba(0, 0, 0, 0.1),
    0 32px 64px -48px rgba(0, 0, 0, 0.5);
  transition: all 0.1s ease;
}

body.show-chatbot .chatbot {
  opacity: 1;
  pointer-events: auto;
  transform: scale(1);
}

.chatbot header {
  padding: 16px 0;
  position: relative;
  text-align: center;
  color: #fff;
  background: #724ae8;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.chatbot header span {
  position: absolute;
  right: 15px;
  top: 50%;
  display: none;
  cursor: pointer;
  transform: translateY(-50%);
}

header h2 {
  font-size: 1.4rem;
}

.chatbot .chatbox {
  overflow-y: auto;
  height: 510px;
  padding: 30px 20px 100px;
}

.chatbot :where(.chatbox, textarea)::-webkit-scrollbar {
  width: 6px;
}

.chatbot :where(.chatbox, textarea)::-webkit-scrollbar-track {
  background: #fff;
  border-radius: 25px;
}

.chatbot :where(.chatbox, textarea)::-webkit-scrollbar-thumb {
  background: #ccc;
  border-radius: 25px;
}

.chatbox .chat {
  display: flex;
  list-style: none;
}

.chatbox .outgoing {
  margin: 20px 0;
  justify-content: flex-end;
}

.chatbox .incoming span {
  width: 32px;
  height: 32px;
  color: #fff;
  cursor: default;
  text-align: center;
  line-height: 32px;
  align-self: flex-end;
  background: #724ae8;
  border-radius: 4px;
  margin: 0 10px 7px 0;
}

.chatbox .chat p {
  white-space: pre-wrap;
  padding: 12px 16px;
  border-radius: 10px 10px 0 10px;
  max-width: 75%;
  color: #fff;
  font-size: 0.95rem;
  background: #724ae8;
}

.chatbox .incoming p {
  border-radius: 10px 10px 10px 0;
}

.chatbox .chat p.error {
  color: #721c24;
  background: #f8d7da;
}

.chatbox .incoming p {
  color: #000;
  background: #f2f2f2;
}

.chatbot .chat-input {
  display: flex;
  gap: 5px;
  position: absolute;
  bottom: 0;
  width: 100%;
  background: #fff;
  padding: 3px 20px;
  border-top: 1px solid #ddd;
}

.chat-input textarea {
  height: 55px;
  width: 100%;
  border: none;
  outline: none;
  resize: none;
  max-height: 180px;
  padding: 15px 15px 15px 0;
  font-size: 0.95rem;
}

.chat-input span {
  align-self: flex-end;
  color: #724ae8;
  cursor: pointer;
  height: 55px;
  display: flex;
  align-items: center;
  visibility: hidden;
  font-size: 1.35rem;
}

.chat-input textarea:valid~span {
  visibility: visible;
}

@media (max-width: 490px) {
  .chatbot-toggler {
    right: 20px;
    bottom: 20px;
  }

  .chatbot {
    right: 0;
    bottom: 0;
    height: 100%;
    border-radius: 0;
    width: 100%;
  }

  .chatbot .chatbox {
    height: 90%;
    padding: 25px 15px 100px;
  }

  .chatbot .chat-input {
    padding: 5px 15px;
  }

  .chatbot header span {
    display: block;
  }
}
    </style> -->
</head>
<body>

    <!-- Navigation Bar -->
    <!-- <nav>
        <div>
            <a href="#">Home</a>
            <a href="#">Top Colleges</a>
            <a href="#">Popular Courses</a>
            <a href="#">Compare Colleges</a>
            <a href="#filter-section">Filters</a> <!-- Updated to point to the filter section -->
        <!-- </div>

        <div class="search-bar">
            <input type="text" placeholder="Search for colleges...">
        </div>

        <div class="nav-buttons">
            <a class="login" id="loginBtn">Login</a>
            <a class="signup" id="signupBtn">Sign Up</a>
        </div>
    </nav> --> 
    <nav>
    <div>
        <a href="#">Home</a>
        <div class="dropdown">
            <a href="#">Top Colleges</a>
            <div class="dropdown-content">
                <a href="#">IIT Bombay</a>
                <a href="#">IIT Delhi</a>
                <a href="#">IIT Madras</a>
                <a href="#">IIT Kanpur</a>
                <a href="#">IIT Kharagpur</a>
            </div>
        </div>
        <div class="dropdown">
            <a href="#">Popular Domains</a>
            <div class="dropdown-content">
                <a href="#">Computer Science & Engineering</a>
                <a href="#">Electrical Engineering</a>
                <a href="#">Mechanical Engineering</a>
                <a href="#">Civil Engineering</a>
                <a href="#">Aerospace Engineering</a>
                <a href="#">Chemical Engineering</a>
                <a href="#">Data Science</a>
                <a href="#">Artificial Intelligence</a>
            </div>
        </div>

        <a href="Table.html">Compare Colleges</a>
        <a href="#filter-section">Filters</a> <!-- Updated to point to the filter section -->
    </div>

    <div class="search-bar">
        <input type="text" placeholder="Search for colleges..." id="collegeSearch" onkeypress="searchCollege(event)">
    </div>

    <div class="nav-buttons">
        <a class="login" id="loginBtn">Login</a>
        <a class="signup" id="signupBtn">Sign Up</a>
    </div>
</nav>

    <!-- Main Section -->
    <div class="main-section">
        <h1>Find Your Perfect College</h1>
        <p>Your journey to success begins with the right education.</p>
        <button>Get Started</button>
    </div>

    <!-- Filter Section -->
    <div class="filter-section" id="filter-section"> <!-- Added id here -->
        <h2>Filter Colleges</h2>
        <form id="filterForm">
            <select id="institute">
                <option value="">Select Institute</option>
                <!-- Institute options will be dynamically populated here -->
            </select>

            <select id="quota">
                <option value="">Select Quota</option>
                <option value="AI">AI</option>
                <option value="OBC">OBC</option>
                <option value="SC">SC</option>
                <option value="ST">ST</option>
                <option value="EWS">EWS</option>
            </select>

            <select id="seatType">
                <option value="">Select Seat Type</option>
                <option value="OPEN">OPEN</option>
                <option value="OPEN (PwD)">OPEN (PwD)</option>
                <option value="EWS">EWS</option>
            </select>

            <select id="gender">
                <option value="">Select Gender</option>
                <option value="Gender-Neutral">Gender-Neutral</option>
                <option value="Female-only">Female-only</option>
            </select>

            <input type="number" id="rank" placeholder="Enter Your Rank">

            <button type="button" onclick="applyFilters()">Apply Filters</button>
        </form>
    </div>

    <!-- Results Section -->
    <div class="results" id="results">
        <h2>Matching Colleges</h2>
        <table id="resultsTable">
            <!-- Filtered results will be displayed here -->
        </table>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeLogin">&times;</span>
            <h2>Login</h2>
            <input type="text" id="loginEmail" placeholder="Email">
            <input type="password" id="loginPassword" placeholder="Password">
            <button onclick="handleLogin()">Login</button>
        </div>
    </div>

    <!-- Signup Modal -->
    <div id="signupModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeSignup">&times;</span>
            <h2>Sign Up</h2>
            <input type="text" id="signupName" placeholder="Full Name">
            <input type="email" id="signupEmail" placeholder="Email">
            <input type="password" id="signupPassword" placeholder="Password">
            <button onclick="handleSignup()">Sign Up</button>
        </div>

    
    </div>
    <!-- //Chatbot -->

    <button class="chatbot-toggler">
        <span class="material-symbols-rounded">mode_comment</span>
        <span class="material-symbols-outlined">close</span>
      </button>
      <div class="chatbot">
        <header>
          <h2>Chatbot</h2>
          <span class="close-btn material-symbols-outlined">close</span>
        </header>
        <ul class="chatbox">
          <li class="chat incoming">
            <span class="material-symbols-outlined">smart_toy</span>
            <p>Hi there 👋<br>How can I help you today?</p>
          </li>
        </ul>
        <div class="chat-input">
          <textarea placeholder="Enter a message..." spellcheck="false" required></textarea>
          <span id="send-btn" class="material-symbols-rounded">send</span>
        </div>
      </div>
    <script>
        let sheetData = [];

        // Load the Excel file data
        fetch('IIT ROUND 1.xlsx')
            .then(response => response.arrayBuffer())
            .then(data => {
                const workbook = XLSX.read(data, {type: 'array'});
                const sheet = workbook.Sheets[workbook.SheetNames[0]];
                sheetData = XLSX.utils.sheet_to_json(sheet);
                populateInstituteOptions();
            });

        // Populate institute options dynamically based on the Excel data
        function populateInstituteOptions() {
            const instituteSelect = document.getElementById('institute');
            const uniqueInstitutes = [...new Set(sheetData.map(row => row['Institute']))];

            uniqueInstitutes.forEach(institute => {
                const option = document.createElement('option');
                option.value = institute;
                option.text = institute;
                instituteSelect.appendChild(option);
            });
        }

        // Apply filters and display results
        function applyFilters() {
            const institute = document.getElementById('institute').value;
            const quota = document.getElementById('quota').value;
            const seatType = document.getElementById('seatType').value;
            const gender = document.getElementById('gender').value;
            const rank = parseInt(document.getElementById('rank').value);

            const filteredData = sheetData.filter(row => {
                return (!institute || row['Institute'] === institute) &&
                       (!quota || row['Quota'] === quota) &&
                       (!seatType || row['Seat Type'] === seatType) &&
                       (!gender || row['Gender'] === gender) &&
                       (!isNaN(rank) ? (row['Opening Rank'] <= rank && row['Closing Rank'] >= rank) : true);
            });

            displayResults(filteredData);
        }

        // Display the filtered results in the table
        function displayResults(data) {
            const resultsTable = document.getElementById('resultsTable');
            resultsTable.innerHTML = `
                <tr>
                    <th>Institute</th>
                    <th>Program</th>
                    <th>Quota</th>
                    <th>Seat Type</th>
                    <th>Gender</th>
                    <th>Opening Rank</th>
                    <th>Closing Rank</th>
                </tr>
            `;

            data.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${row['Institute']}</td>
                    <td>${row['Academic Program Name']}</td>
                    <td>${row['Quota']}</td>
                    <td>${row['Seat Type']}</td>
                    <td>${row['Gender']}</td>
                    <td>${row['Opening Rank']}</td>
                    <td>${row['Closing Rank']}</td>
                `;
                resultsTable.appendChild(tr);
            });
        }

        // Modal functionality
        const loginModal = document.getElementById("loginModal");
        const signupModal = document.getElementById("signupModal");

        document.getElementById("loginBtn").onclick = function() {
            loginModal.style.display = "block";
        }

        document.getElementById("signupBtn").onclick = function() {
            signupModal.style.display = "block";
        }

        document.getElementById("closeLogin").onclick = function() {
            loginModal.style.display = "none";
        }

        document.getElementById("closeSignup").onclick = function() {
            signupModal.style.display = "none";
        }

        window.onclick = function(event) {
            if (event.target === loginModal) {
                loginModal.style.display = "none";
            }
            if (event.target === signupModal) {
                signupModal.style.display = "none";
            }
        }

        // Handle login
        function handleLogin() {
            const email = document.getElementById("loginEmail").value;
            const password = document.getElementById("loginPassword").value;
            // Add login logic here (e.g., API call, validation, etc.)
            alert(Logged in as ${email});
            loginModal.style.display = "none";
        }

        // Handle signup
        function handleSignup() {
            const name = document.getElementById("signupName").value;
            const email = document.getElementById("signupEmail").value;
            const password = document.getElementById("signupPassword").value;
            // Add signup logic here (e.g., API call, validation, etc.)
            alert(Signed up as: ${name});
            signupModal.style.display = "none";
        }

        function searchCollege(event) {
        if (event.key === 'Enter') {
            const collegeName = document.getElementById('collegeSearch').value;
            // Open the college details page with the college name as a query parameter
            window.location.href = college-details.html?college=${encodeURIComponent(collegeName)};
            }
        }
        const chatbotToggler = document.querySelector(".chatbot-toggler");
const closeBtn = document.querySelector(".close-btn");
const chatbox = document.querySelector(".chatbox");
const chatInput = document.querySelector(".chat-input textarea");
const sendChatBtn = document.querySelector(".chat-input span");

let userMessage = null; // Variable to store user's message
const inputInitHeight = chatInput.scrollHeight;

// API configuration
const API_KEY = "AIzaSyB6iO9-NYj6NZ-C9Oar-jpDW3PFIAqMUes"; // Your API key here
const API_URL = https://generativelanguage.googleapis.com/v1/models/gemini-pro:generateContent?key=${API_KEY};

// IIT-related keywords
const iitKeywords = [
  "IIT", "Indian Institute of Technology", "IIT Delhi", "IIT Bombay", "IIT Kanpur","IIT Guwahati", 
  "IIT Bhilai","IIT Jammu","IIT Tirupati","IIT Dharwad","IIT Palakkad","IIT Kharagpur","IIT Goa",
  "IIT Varanasi","IIT BHU","BHU","IIT Ropar","IIT ISM","IIT Roorkee","IIT Patna","IIT Gandhinagar",
  "IIT Madras","IIT Chennai","IIT Jodhpur","IIT Hyderabad","IIT Indore","IIT Mandi","IIT Bhubneshwar",
  "IIT ranking", "IIT admission","JEE", "IIT courses", "IIT faculty", "IIT research", "IIT fees"
]; 

// Function to check if the message is related to IITs
const isIITRelated = (message) => {
  return iitKeywords.some(keyword => message.toLowerCase().includes(keyword.toLowerCase()));
};

// Function to create a chat <li> element
const createChatLi = (message, className) => {
  const chatLi = document.createElement("li");
  chatLi.classList.add("chat", ${className});
  let chatContent = className === "outgoing" 
    ? <p></p> 
    : <span class="material-symbols-outlined">smart_toy</span><p></p>;
  chatLi.innerHTML = chatContent;
  chatLi.querySelector("p").textContent = message;
  return chatLi;
};

// Function to generate the response
const generateResponse = async (chatElement) => {
  const messageElement = chatElement.querySelector("p");

  // Check if the message is related to IITs
  if (!isIITRelated(userMessage)) {
    messageElement.textContent = "I can only answer questions related to IITs. Please ask something about IITs.";
    return;
  }

  // Define the properties and message for the API request
  const requestOptions = {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ 
      contents: [{ 
        role: "user", 
        parts: [{ text: userMessage }] 
      }] 
    }),
  };

  // Send POST request to API, get response, and update the message element
  try {
    const response = await fetch(API_URL, requestOptions);
    const data = await response.json();
    if (!response.ok) throw new Error(data.error.message);

    messageElement.textContent = data.candidates[0].content.parts[0].text.replace(/\\(.?)\\*/g, '$1');
  } catch (error) {
    messageElement.classList.add("error");
    messageElement.textContent = error.message;
  } finally {
    chatbox.scrollTo(0, chatbox.scrollHeight);
  }
};

// Function to handle the chat
const handleChat = () => {
  userMessage = chatInput.value.trim(); // Get user entered message and remove extra whitespace
  if (!userMessage) return;

  // Clear the input textarea and reset its height
  chatInput.value = "";
  chatInput.style.height = ${inputInitHeight}px;

  // Append the user's message to the chatbox
  chatbox.appendChild(createChatLi(userMessage, "outgoing"));
  chatbox.scrollTo(0, chatbox.scrollHeight);

  // Display "Thinking..." message and generate the response
  setTimeout(() => {
    const incomingChatLi = createChatLi("Thinking...", "incoming");
    chatbox.appendChild(incomingChatLi);
    chatbox.scrollTo(0, chatbox.scrollHeight);
    generateResponse(incomingChatLi);
  }, 600);
};

// Event listener for the chat input
chatInput.addEventListener("input", () => {
  chatInput.style.height = ${inputInitHeight}px;
  chatInput.style.height = ${chatInput.scrollHeight}px;
});

// Event listener for the "Enter" key press to send the message
chatInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter" && !e.shiftKey && window.innerWidth > 800) {
    e.preventDefault();
    handleChat();
  }
});

// Event listener for the send button click
sendChatBtn.addEventListener("click", handleChat);

// Event listeners for opening and closing the chatbot
closeBtn.addEventListener("click", () => document.body.classList.remove("show-chatbot"));
chatbotToggler.addEventListener("click", () => document.body.classList.toggle("show-chatbot"));

    </script>

</body>
</html>